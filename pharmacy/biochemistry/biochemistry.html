<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pharmacy Exam - Chapters 1 & 2</title>
    <style>
        * {
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        body {
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
            color: #333;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
        }
        h1 {
            color: #2c3e50;
            text-align: center;
            margin-bottom: 10px;
        }
        .subtitle {
            text-align: center;
            color: #7f8c8d;
            margin-bottom: 30px;
        }
        .screen {
            display: none;
        }
        .active {
            display: block;
        }
        .form-group {
            margin-bottom: 15px;
        }
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }
        input[type="text"] {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 5px;
            font-size: 16px;
        }
        button {
            background-color: #3498db;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
            margin-right: 10px;
            transition: background-color 0.3s;
        }
        button:hover {
            background-color: #2980b9;
        }
        button:disabled {
            background-color: #bdc3c7;
            cursor: not-allowed;
        }
        .btn-primary {
            background-color: #2ecc71;
        }
        .btn-primary:hover {
            background-color: #27ae60;
        }
        .btn-secondary {
            background-color: #95a5a6;
        }
        .btn-secondary:hover {
            background-color: #7f8c8d;
        }
        .timer {
            font-size: 18px;
            font-weight: bold;
            text-align: right;
            margin-bottom: 15px;
            color: #e74c3c;
        }
        .question {
            margin-bottom: 20px;
            padding: 15px;
            background-color: #f8f9fa;
            border-radius: 5px;
        }
        .question-number {
            font-weight: bold;
            margin-bottom: 10px;
            color: #2c3e50;
        }
        .options {
            margin-left: 20px;
        }
        .option {
            margin-bottom: 10px;
            padding: 8px;
            cursor: pointer;
            border-radius: 5px;
        }
        .option:hover {
            background-color: #ecf0f1;
        }
        .option.selected {
            background-color: #d5edf7;
            border: 1px solid #3498db;
        }
        .correct {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
        }
        .incorrect {
            background-color: #f8d7da;
            border: 1px solid #f5c6cb;
        }
        .feedback {
            margin-top: 15px;
            padding: 10px;
            border-radius: 5px;
            display: none;
        }
        .feedback.correct {
            background-color: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .feedback.incorrect {
            background-color: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
        .explanation {
            margin-top: 10px;
            font-style: italic;
        }
        .progress {
            margin-bottom: 15px;
        }
        .progress-bar {
            height: 10px;
            background-color: #ecf0f1;
            border-radius: 5px;
            overflow: hidden;
        }
        .progress-fill {
            height: 100%;
            background-color: #3498db;
            width: 0%;
            transition: width 0.3s;
        }
        .results {
            text-align: center;
            margin-top: 30px;
        }
        .score {
            font-size: 24px;
            font-weight: bold;
            margin-bottom: 20px;
        }
        .review-options {
            margin-top: 20px;
        }
        .navigation {
            display: flex;
            justify-content: space-between;
            margin-top: 20px;
        }
        .attempt-info {
            background-color: #e8f4fd;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Pharmacy Exam</h1>
        <div class="subtitle">Chapters 1 & 2</div>
        
        <!-- Welcome Screen -->
        <div id="welcome-screen" class="screen active">
          <a href="https://t.me/yerotechno"><h1>MedQuiz</h1></a>
            <h2>Welcome to the Pharmacy Exam</h2>
            <p>This exam covers Chapters 1 & 2 of the Pharmacy course material.</p>
            <p>You will have 60 minutes to complete 50 questions.</p>
            <div id="first-attempt-info" class="attempt-info" style="display:none;">
                <p><strong>First Attempt Mode</strong></p>
                <p>Your results will be submitted to the <del>instructor.</del></p>
            </div>
            <div id="practice-attempt-info" class="attempt-info" style="display:none;">
                <p><strong>Practice Mode</strong></p>
                <p>Your results will not be submitted you can practice now</p>
            </div>
            <button id="start-exam-btn" class="btn-primary">Start Exam</button>
        </div>
        
        <!-- Student Information Screen -->
        <div id="student-info-screen" class="screen">
            <h2>Student Information</h2>
            <form id="student-form">
                <div class="form-group">
                    <label for="student-name">Full Name:</label>
                    <input type="text" id="student-name" required>
                </div>
                <div class="form-group">
                    <label for="student-id">Student ID:</label>
                    <input type="text" id="student-id" required>
                </div>
                <button type="button" id="continue-exam-btn" class="btn-primary">Continue to Exam</button>
            </form>
        </div>
        
        <!-- Exam Screen -->
        <div id="exam-screen" class="screen">
            <div class="timer" id="timer">Time Remaining: 60:00</div>
            <div class="progress">
                <div class="progress-bar">
                    <div class="progress-fill" id="progress-fill"></div>
                </div>
                <div id="question-counter">Question 1 of 50</div>
            </div>
            
            <div class="question">
                <div class="question-number" id="question-number">Question 1</div>
                <div id="question-text"></div>
                <div class="options" id="options-container"></div>
                <div class="feedback" id="feedback"></div>
            </div>
            
            <div class="navigation">
                <button id="prev-btn" disabled>Previous</button>
                <button id="next-btn">Next</button>
                <button id="submit-exam-btn" class="btn-primary" style="display:none;">Submit Exam</button>
            </div>
        </div>
        
        <!-- Results Screen -->
        <div id="results-screen" class="screen">
            <h2>Exam Results</h2>
            <div class="results">
                <div class="score" id="score-display"></div>
                <div id="results-details"></div>
                
                <div class="review-options">
                    <h3>Review Options</h3>
                    <p>Would you like to review the questions with feedback?</p>
                    <button id="immediate-feedback-btn">Immediate Feedback</button>
                    <button id="end-feedback-btn">Feedback at the End</button>
                    <button id="retry-exam-btn" class="btn-secondary">Retry Exam (Practice)</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Questions data for Chapters 1 & 2
        const questions = [
            {
                question: "What does the sig code q6h mean?",
                options: [
                    "A) at 6 A.M",
                    "B) Every 6 hours",
                    "C) at 6 P.M",
                    "D) six times a day"
                ],
                correctAnswer: 1,
                explanation: "q6h means every 6 hours."
            },
            {
                question: "What does PRN mean?",
                options: [
                    "A) Immediately",
                    "B) As needed",
                    "C) Rectally",
                    "D) after a meal"
                ],
                correctAnswer: 1,
                explanation: "PRN is an abbreviation for 'pro re nata', which means 'as needed'."
            },
            {
                question: "The route of administration sig code for topical patch is ___",
                options: [
                    "A) SC",
                    "B) IM",
                    "C) ID",
                    "D) TD"
                ],
                correctAnswer: 3,
                explanation: "TD stands for transdermal, which refers to topical patches."
            },
            {
                question: "Which one of the following abbreviations is NOT a liquid?",
                options: [
                    "A) Susp",
                    "B) Supp",
                    "C) Syr",
                    "D) Sol"
                ],
                correctAnswer: 1,
                explanation: "Supp stands for suppository, which is a solid dosage form."
            },
            {
                question: "Which sig code means 'Under the tongue'?",
                options: [
                    "A) SL",
                    "B) PO",
                    "C) IM",
                    "D) AU"
                ],
                correctAnswer: 0,
                explanation: "SL stands for sublingual, which means under the tongue."
            },
            {
                question: "What does 'i gtt OS' mean?",
                options: [
                    "A) One drop into the left ear",
                    "B) One drop into the right eye",
                    "C) One drop into the right ear",
                    "D) One drop into the left eye"
                ],
                correctAnswer: 3,
                explanation: "i means one, gtt means drop, OS means left eye."
            },
            {
                question: "What does 'ii gtts AD' mean?",
                options: [
                    "A) Two drops into the left ear",
                    "B) Two drops into the right eye",
                    "C) Two drops into the right ear",
                    "D) Two drops into the left eye"
                ],
                correctAnswer: 1,
                explanation: "ii means two, gtts means drops, AD means right ear."
            },
            {
                question: "Which Sig code is not the frequency of 'once a day'?",
                options: [
                    "A) qAM",
                    "B) qPM",
                    "C) qid",
                    "D) qHS"
                ],
                correctAnswer: 2,
                explanation: "qid means four times a day, not once a day."
            },
            {
                question: "What is the sig code for 'I capsule by mouth twice a day'?",
                options: [
                    "A) I cap PO QID",
                    "B) I cap PO QD",
                    "C) I cap PO BID",
                    "D) I cap PO TID"
                ],
                correctAnswer: 2,
                explanation: "BID means twice a day."
            },
            {
                question: "A prescription for Ciprodex® otic may contain the sig code:",
                options: [
                    "A) AU",
                    "B) OD",
                    "C) IM",
                    "D) PO"
                ],
                correctAnswer: 0,
                explanation: "AU means both ears, which is appropriate for an otic (ear) medication."
            },
            {
                question: "What is the sig code for 'under the skin'?",
                options: [
                    "A) SQ",
                    "B) IV",
                    "C) IM",
                    "D) ID"
                ],
                correctAnswer: 0,
                explanation: "SQ or SC stands for subcutaneous, which means under the skin."
            },
            {
                question: "Which of the following is not a topical product?",
                options: [
                    "A) Ung",
                    "B) cr",
                    "C) lot",
                    "D) Inh"
                ],
                correctAnswer: 3,
                explanation: "Inh stands for inhalation, which is not a topical product."
            },
            {
                question: "What does 'íi tab PO HS' mean?",
                options: [
                    "A) 2 tablets by mouth with food",
                    "B) 2 tablets by mouth at bedtime",
                    "C) 11 tablets by mouth each week",
                    "D) 2 tablets under tongue now"
                ],
                correctAnswer: 1,
                explanation: "ii means two, PO means by mouth, HS means at bedtime."
            },
            {
                question: "'Give the amount needed' is indicated by which sig code?",
                options: [
                    "A) DAW",
                    "B) NR",
                    "C) QS",
                    "D) UD"
                ],
                correctAnswer: 2,
                explanation: "QS stands for 'quantum satis' which means 'the amount needed'."
            },
            {
                question: "A sig code reads 2 BID x7d. What does x7d mean?",
                options: [
                    "A) Seven times a day",
                    "B) For seven days",
                    "C) For seven doses",
                    "D) Dispense seven doses"
                ],
                correctAnswer: 1,
                explanation: "x7d means for seven days."
            },
            {
                question: "What does 'ív tab pc' mean?",
                options: [
                    "A) Take six tablets after meals",
                    "B) Take four tablets after meals",
                    "C) Take six tablets before meals",
                    "D) Take four tablets before meals"
                ],
                correctAnswer: 1,
                explanation: "ív means four, tab means tablets, pc means after meals."
            },
            {
                question: "What are the four parts of prescription?",
                options: [
                    "A) Superscription, Inscription, Subscription, Signature",
                    "B) Header, Body, Footer, Signature",
                    "C) Patient info, Drug info, Directions, Date",
                    "D) Rx, Drug name, Quantity, Instructions"
                ],
                correctAnswer: 0,
                explanation: "The four parts of prescription are: Superscription, Inscription, Subscription, and Signature."
            },
            {
                question: "Which of the following is NOT one of the four parts of a prescription?",
                options: [
                    "A) Superscription",
                    "B) Inscription",
                    "C) Subscription",
                    "D) Authentication"
                ],
                correctAnswer: 3,
                explanation: "The four parts are Superscription, Inscription, Subscription, and Signature."
            },
            {
                question: "The symbol Rx in a prescription stands for:",
                options: [
                    "A) Recipe",
                    "B) Right",
                    "C) Prescription",
                    "D) Treatment"
                ],
                correctAnswer: 0,
                explanation: "Rx is an abbreviation for 'recipe,' the Latin for 'take'."
            },
            {
                question: "Which part of the prescription contains the directions to the patient?",
                options: [
                    "A) Superscription",
                    "B) Inscription",
                    "C) Subscription",
                    "D) Signature"
                ],
                correctAnswer: 3,
                explanation: "The Signature contains directions to the patient on how to take the medication."
            },
            {
                question: "Which type of drugs may not be dispensed by a pharmacist without a prescription?",
                options: [
                    "A) OTC drugs",
                    "B) Legend drugs",
                    "C) Controlled drugs",
                    "D) All of the above"
                ],
                correctAnswer: 1,
                explanation: "Legend drugs require a prescription from a physician."
            },
            {
                question: "What is the color of prescription paper for narcotic drugs in Ethiopia?",
                options: [
                    "A) White",
                    "B) Blue",
                    "C) Red",
                    "D) Yellow"
                ],
                correctAnswer: 2,
                explanation: "Narcotic drugs prescription has Red color."
            },
            {
                question: "Psychotropic substance prescriptions in Ethiopia have which color?",
                options: [
                    "A) White",
                    "B) Blue",
                    "C) Red",
                    "D) Yellow"
                ],
                correctAnswer: 1,
                explanation: "Psychotropic substance prescription has Blue color."
            },
            {
                question: "Which of the following is a narcotic drug?",
                options: [
                    "A) Diazepam",
                    "B) Codeine",
                    "C) Phenobarbitone",
                    "D) Ibuprofen"
                ],
                correctAnswer: 1,
                explanation: "Codeine is a narcotic drug."
            },
            {
                question: "Which of the following is a psychotropic substance?",
                options: [
                    "A) Morphine",
                    "B) Codeine",
                    "C) Diazepam",
                    "D) Methadone"
                ],
                correctAnswer: 2,
                explanation: "Diazepam is a psychotropic substance."
            },
            {
                question: "How long should conventional (ordinary) prescription records be maintained?",
                options: [
                    "A) 1 year",
                    "B) 2 years",
                    "C) 5 years",
                    "D) 10 years"
                ],
                correctAnswer: 1,
                explanation: "Conventional prescription records should be maintained for 2 years."
            },
            {
                question: "How long should controlled substance prescription records be maintained?",
                options: [
                    "A) 1 year",
                    "B) 2 years",
                    "C) 5 years",
                    "D) 10 years"
                ],
                correctAnswer: 2,
                explanation: "Controlled substance prescription records should be maintained for at least 5 years."
            },
            {
                question: "The healthcare system in Ethiopia was founded in:",
                options: [
                    "A) 1908",
                    "B) 1952",
                    "C) 1963",
                    "D) 1974"
                ],
                correctAnswer: 0,
                explanation: "The healthcare system in Ethiopia was founded in 1908."
            },
            {
                question: "Basic health service in Ethiopia was founded in:",
                options: [
                    "A) 1908",
                    "B) 1952",
                    "C) 1963",
                    "D) 1974"
                ],
                correctAnswer: 1,
                explanation: "Basic health service in Ethiopia was founded in 1952."
            },
            {
                question: "The first national health policy and strategy in Ethiopia was developed in:",
                options: [
                    "A) 1908",
                    "B) 1952",
                    "C) 1963",
                    "D) 1974"
                ],
                correctAnswer: 2,
                explanation: "The first national health policy and strategy was developed in 1963 with the second five-year development plan."
            },
            {
                question: "The Alma-Ata declaration aimed for Health For All (HFA) by:",
                options: [
                    "A) 1978",
                    "B) 1985",
                    "C) 1990",
                    "D) 2000"
                ],
                correctAnswer: 3,
                explanation: "The Alma-Ata declaration aimed for Health For All by 2000."
            },
            {
                question: "The current Ethiopian health policy gives priority to:",
                options: [
                    "A) Urban population",
                    "B) Rural and unprivileged urban population",
                    "C) Children and elderly",
                    "D) All of the above"
                ],
                correctAnswer: 1,
                explanation: "The current Ethiopian health policy gives priority to the rural and unprivileged urban population."
            },
            {
                question: "Which of the following is NOT one of the three pillars of the Ethiopian health sector?",
                options: [
                    "A) Service provider",
                    "B) Service purchaser",
                    "C) Health regulator",
                    "D) Health insurance"
                ],
                correctAnswer: 3,
                explanation: "The three pillars are Service provider, Service purchaser, and Health regulator."
            },
            {
                question: "Which of the following is part of the service provider pillar in Ethiopia?",
                options: [
                    "A) FMOH",
                    "B) EHNRI",
                    "C) PFSA",
                    "D) All of the above"
                ],
                correctAnswer: 3,
                explanation: "All of these are part of the service provider pillar."
            },
            {
                question: "Which of the following is part of the health regulator pillar in Ethiopia?",
                options: [
                    "A) FMHACA",
                    "B) PFSA",
                    "C) HAPCO",
                    "D) EHNRI"
                ],
                correctAnswer: 0,
                explanation: "FMHACA is part of the health regulator pillar."
            },
            {
                question: "The Health Service Extension Package in Ethiopia focuses on all EXCEPT:",
                options: [
                    "A) Hygiene and Environmental Sanitation",
                    "B) Disease Prevention and Control",
                    "C) Surgical interventions",
                    "D) Family Health Service"
                ],
                correctAnswer: 2,
                explanation: "The Health Service Extension Package does not include surgical interventions."
            },
            {
                question: "Which of the following is NOT a component of the Essential Health Service Package?",
                options: [
                    "A) To enhance effectiveness of health sector programs",
                    "B) To promote standardization of essential service",
                    "C) To serve as management tool",
                    "D) To provide specialized surgical procedures"
                ],
                correctAnswer: 3,
                explanation: "Providing specialized surgical procedures is not a component of the Essential Health Service Package."
            },
            {
                question: "The first pharmacy in Ethiopia serving the general public was established in:",
                options: [
                    "A) 1908",
                    "B) 1911",
                    "C) 1930",
                    "D) 1961"
                ],
                correctAnswer: 1,
                explanation: "'Pharmazie la Gorgie' was established in November 1911 by Dr. Merab."
            },
            {
                question: "The first legislation regulating pharmacy in Ethiopia was promulgated in:",
                options: [
                    "A) 1908",
                    "B) 1911",
                    "C) 1930",
                    "D) 1961"
                ],
                correctAnswer: 2,
                explanation: "The first legislation was promulgated in July 18, 1930."
            },
            {
                question: "The School of Pharmacy in Addis Ababa University was established in:",
                options: [
                    "A) 1908",
                    "B) 1911",
                    "C) 1930",
                    "D) 1961-1962"
                ],
                correctAnswer: 3,
                explanation: "The School of Pharmacy was established in 1961-1962 (1954 EC)."
            },
            {
                question: "The Ethiopian Pharmaceutical Association (EPA) was formed in:",
                options: [
                    "A) 1930",
                    "B) 1961",
                    "C) 1974",
                    "D) 2001"
                ],
                correctAnswer: 2,
                explanation: "EPA was formed officially in November 1974 with 40 members."
            },
            {
                question: "Which of the following is NOT a type of pharmacy setting in Ethiopia?",
                options: [
                    "A) Pharmacy",
                    "B) Drug store",
                    "C) Rural drug vendors",
                    "D) Online pharmacy"
                ],
                correctAnswer: 3,
                explanation: "Online pharmacy is not mentioned as a type of pharmacy setting in Ethiopia."
            },
            {
                question: "A pharmacy in Ethiopia must be managed by:",
                options: [
                    "A) A registered and licensed pharmacist",
                    "B) A registered druggist",
                    "C) A pharmacy technician",
                    "D) Any health professional"
                ],
                correctAnswer: 0,
                explanation: "A pharmacy must be managed under the responsibility of a registered and licensed pharmacist."
            },
            {
                question: "A drug store in Ethiopia must be managed by:",
                options: [
                    "A) A registered and licensed pharmacist",
                    "B) A registered druggist",
                    "C) A pharmacy technician",
                    "D) Any health professional"
                ],
                correctAnswer: 1,
                explanation: "A drug store must be managed under the responsibility of a registered druggist."
            },
            {
                question: "Rural drug vendors in Ethiopia must be managed by:",
                options: [
                    "A) A registered and licensed pharmacist",
                    "B) A registered druggist",
                    "C) A pharmacy technician",
                    "D) Any health professional"
                ],
                correctAnswer: 2,
                explanation: "Rural drug vendors must be managed under the responsibility of a registered pharmacy technician."
            },
            {
                question: "The minimum experience required for a pharmacist to manage a pharmacy in Ethiopia is:",
                options: [
                    "A) 1 year",
                    "B) 2 years",
                    "C) 3 years",
                    "D) 5 years"
                ],
                correctAnswer: 2,
                explanation: "A minimum experience of three years is required."
            },
            {
                question: "A pharmacy in Ethiopia can only be established where there is at least:",
                options: [
                    "A) One health center",
                    "B) One hospital giving services to the public",
                    "C) One clinic",
                    "D) One health post"
                ],
                correctAnswer: 1,
                explanation: "A pharmacy can only be established where there is at least one hospital giving services to the public."
            },
            {
                question: "A drug store in Ethiopia can be established where there is at least:",
                options: [
                    "A) One health center",
                    "B) One hospital giving services to the public",
                    "C) One clinic",
                    "D) One health post"
                ],
                correctAnswer: 0,
                explanation: "A drug store can be established where there is at least one health center giving service."
            },
            {
                question: "Which of the following is NOT a common department of pharmacy?",
                options: [
                    "A) Pharmacology and therapeutics",
                    "B) Pharmacognosy",
                    "C) Pharmaceutics",
                    "D) Pharmacy administration"
                ],
                correctAnswer: 3,
                explanation: "Pharmacy administration is not listed as a common department of pharmacy."
            },
            {
                question: "Which department deals with how drugs interact within biological systems?",
                options: [
                    "A) Pharmacology and therapeutics",
                    "B) Pharmacognosy",
                    "C) Pharmaceutics",
                    "D) Pharmaceutical chemistry"
                ],
                correctAnswer: 0,
                explanation: "Pharmacology and therapeutics deals with how drugs interact within biological systems."
            },
            {
                question: "Which department deals with the study of natural products?",
                options: [
                    "A) Pharmacology and therapeutics",
                    "B) Pharmacognosy",
                    "C) Pharmaceutics",
                    "D) Pharmaceutical chemistry"
                ],
                correctAnswer: 1,
                explanation: "Pharmacognosy is the study of natural products."
            },
            {
                question: "Which department deals with the conversion of chemicals into medications?",
                options: [
                    "A) Pharmacology and therapeutics",
                    "B) Pharmacognosy",
                    "C) Pharmaceutics",
                    "D) Pharmaceutical chemistry"
                ],
                correctAnswer: 2,
                explanation: "Pharmaceutics deals with the conversion of chemicals into medications."
            },
            {
                question: "Which department is involved in the synthesis and quality control of drugs?",
                options: [
                    "A) Pharmacology and therapeutics",
                    "B) Pharmacognosy",
                    "C) Pharmaceutics",
                    "D) Pharmaceutical chemistry"
                ],
                correctAnswer: 3,
                explanation: "Pharmaceutical chemistry is involved in the synthesis and quality control of drugs."
            }
        ];

        // Application state
        let currentQuestionIndex = 0;
        let userAnswers = new Array(questions.length).fill(null);
        let timer;
        let timeLeft = 60 * 60; // 60 minutes in seconds
        let examStarted = false;
        let studentName = "";
        let studentId = "";
        let feedbackMode = null; // 'immediate' or 'end'
        let isFirstAttempt = true;
        let isPracticeMode = false;

        // Check if user has already completed first attempt
        function checkFirstAttemptStatus() {
            const firstAttemptCompleted = localStorage.getItem('pharmacyExamFirstAttemptCompleted');
            if (firstAttemptCompleted === 'true') {
                isFirstAttempt = false;
                studentName = localStorage.getItem('pharmacyExamStudentName') || '';
                studentId = localStorage.getItem('pharmacyExamStudentId') || '';
            }
        }

        // DOM elements
        const welcomeScreen = document.getElementById('welcome-screen');
        const studentInfoScreen = document.getElementById('student-info-screen');
        const examScreen = document.getElementById('exam-screen');
        const resultsScreen = document.getElementById('results-screen');
        const startExamBtn = document.getElementById('start-exam-btn');
        const continueExamBtn = document.getElementById('continue-exam-btn');
        const timerElement = document.getElementById('timer');
        const questionNumberElement = document.getElementById('question-number');
        const questionTextElement = document.getElementById('question-text');
        const optionsContainer = document.getElementById('options-container');
        const feedbackElement = document.getElementById('feedback');
        const prevBtn = document.getElementById('prev-btn');
        const nextBtn = document.getElementById('next-btn');
        const submitExamBtn = document.getElementById('submit-exam-btn');
        const progressFill = document.getElementById('progress-fill');
        const questionCounter = document.getElementById('question-counter');
        const scoreDisplay = document.getElementById('score-display');
        const resultsDetails = document.getElementById('results-details');
        const immediateFeedbackBtn = document.getElementById('immediate-feedback-btn');
        const endFeedbackBtn = document.getElementById('end-feedback-btn');
        const retryExamBtn = document.getElementById('retry-exam-btn');
        const firstAttemptInfo = document.getElementById('first-attempt-info');
        const practiceAttemptInfo = document.getElementById('practice-attempt-info');

        // Event listeners
        startExamBtn.addEventListener('click', startExam);
        continueExamBtn.addEventListener('click', continueToExam);
        prevBtn.addEventListener('click', showPreviousQuestion);
        nextBtn.addEventListener('click', showNextQuestion);
        submitExamBtn.addEventListener('click', submitExam);
        immediateFeedbackBtn.addEventListener('click', () => startReview('immediate'));
        endFeedbackBtn.addEventListener('click', () => startReview('end'));
        retryExamBtn.addEventListener('click', retryExam);

        // Initialize
        checkFirstAttemptStatus();
        updateWelcomeScreen();

        function updateWelcomeScreen() {
            if (isFirstAttempt) {
                firstAttemptInfo.style.display = 'block';
                practiceAttemptInfo.style.display = 'none';
            } else {
                firstAttemptInfo.style.display = 'none';
                practiceAttemptInfo.style.display = 'block';
            }
        }

        function startExam() {
            if (isFirstAttempt) {
                // First attempt - show student info screen
                welcomeScreen.classList.remove('active');
                studentInfoScreen.classList.add('active');
            } else {
                // Not first attempt - go directly to exam in practice mode
                isPracticeMode = true;
                studentName = localStorage.getItem('pharmacyExamStudentName') || 'Practice User';
                studentId = localStorage.getItem('pharmacyExamStudentId') || 'Practice ID';
                welcomeScreen.classList.remove('active');
                examScreen.classList.add('active');
                examStarted = true;
                loadQuestion(currentQuestionIndex);
                startTimer();
            }
        }

        function continueToExam() {
            studentName = document.getElementById('student-name').value;
            studentId = document.getElementById('student-id').value;
            
            if (!studentName || !studentId) {
                alert('Please enter your name and ID');
                return;
            }
            
            // Store student info for future use
            localStorage.setItem('pharmacyExamStudentName', studentName);
            localStorage.setItem('pharmacyExamStudentId', studentId);
            
            studentInfoScreen.classList.remove('active');
            examScreen.classList.add('active');
            examStarted = true;
            
            loadQuestion(currentQuestionIndex);
            startTimer();
        }

        function loadQuestion(index) {
            // Update progress bar
            const progress = ((index + 1) / questions.length) * 100;
            progressFill.style.width = `${progress}%`;
            questionCounter.textContent = `Question ${index + 1} of ${questions.length}`;
            
            // Update question number and text
            questionNumberElement.textContent = `Question ${index + 1}`;
            questionTextElement.textContent = questions[index].question;
            
            // Clear previous options
            optionsContainer.innerHTML = '';
            
            // Add new options
            questions[index].options.forEach((option, optionIndex) => {
                const optionElement = document.createElement('div');
                optionElement.className = 'option';
                if (userAnswers[index] === optionIndex) {
                    optionElement.classList.add('selected');
                }
                optionElement.textContent = option;
                optionElement.addEventListener('click', () => selectOption(optionIndex));
                optionsContainer.appendChild(optionElement);
            });
            
            // Update navigation buttons
            prevBtn.disabled = index === 0;
            nextBtn.disabled = index === questions.length - 1;
            
            // Show submit button if on last question
            if (index === questions.length - 1) {
                submitExamBtn.style.display = 'inline-block';
                nextBtn.style.display = 'none';
            } else {
                submitExamBtn.style.display = 'none';
                nextBtn.style.display = 'inline-block';
            }
            
            // Show/hide feedback based on mode
            if (feedbackMode === 'immediate' && userAnswers[index] !== null) {
                showFeedback(index);
            } else {
                feedbackElement.style.display = 'none';
            }
        }

        function selectOption(optionIndex) {
            userAnswers[currentQuestionIndex] = optionIndex;
            loadQuestion(currentQuestionIndex);
            
            if (feedbackMode === 'immediate') {
                showFeedback(currentQuestionIndex);
            }
        }

        function showFeedback(index) {
            const question = questions[index];
            const userAnswer = userAnswers[index];
            
            feedbackElement.textContent = '';
            feedbackElement.className = 'feedback';
            
            if (userAnswer === null) {
                feedbackElement.style.display = 'none';
                return;
            }
            
            if (userAnswer === question.correctAnswer) {
                feedbackElement.textContent = 'Correct!';
                feedbackElement.classList.add('correct');
            } else {
                feedbackElement.textContent = 'Incorrect!';
                feedbackElement.classList.add('incorrect');
            }
            
            const explanation = document.createElement('div');
            explanation.className = 'explanation';
            explanation.textContent = question.explanation;
            feedbackElement.appendChild(explanation);
            
            feedbackElement.style.display = 'block';
            
            // Update option colors
            const options = optionsContainer.getElementsByClassName('option');
            for (let i = 0; i < options.length; i++) {
                options[i].classList.remove('correct', 'incorrect');
                if (i === question.correctAnswer) {
                    options[i].classList.add('correct');
                } else if (i === userAnswer && i !== question.correctAnswer) {
                    options[i].classList.add('incorrect');
                }
            }
        }

        function showPreviousQuestion() {
            if (currentQuestionIndex > 0) {
                currentQuestionIndex--;
                loadQuestion(currentQuestionIndex);
            }
        }

        function showNextQuestion() {
            if (currentQuestionIndex < questions.length - 1) {
                currentQuestionIndex++;
                loadQuestion(currentQuestionIndex);
            }
        }

        function startTimer() {
            updateTimerDisplay();
            timer = setInterval(updateTimer, 1000);
        }

        function updateTimer() {
            timeLeft--;
            updateTimerDisplay();
            
            if (timeLeft <= 0) {
                clearInterval(timer);
                submitExam();
            }
        }

        function updateTimerDisplay() {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            timerElement.textContent = `Time Remaining: ${minutes}:${seconds < 10 ? '0' : ''}${seconds}`;
        }

        function submitExam() {
            clearInterval(timer);
            examStarted = false;
            
            // Calculate score
            let score = 0;
            questions.forEach((question, index) => {
                if (userAnswers[index] === question.correctAnswer) {
                    score++;
                }
            });
            
            const percentage = (score / questions.length) * 100;
            
            // Display results
            scoreDisplay.textContent = `Your Score: ${score}/${questions.length} (${percentage.toFixed(1)}%)`;
            
            let detailsHtml = `<p>Student: ${studentName} (ID: ${studentId})</p>`;
            detailsHtml += `<p>Date: ${new Date().toLocaleDateString()}</p>`;
            detailsHtml += `<p>Mode: ${isPracticeMode ? 'Practice' : (isFirstAttempt ? 'First Attempt' : 'Review')}</p>`;
            resultsDetails.innerHTML = detailsHtml;
            
            // Submit to Formspree only on first attempt
            if (isFirstAttempt && !isPracticeMode) {
                submitToFormspree(score, percentage);
                // Mark first attempt as completed
                localStorage.setItem('pharmacyExamFirstAttemptCompleted', 'true');
                isFirstAttempt = false;
            }
            
            // Show results screen
            examScreen.classList.remove('active');
            resultsScreen.classList.add('active');
        }

        function submitToFormspree(score, percentage) {
            const formData = new FormData();
            formData.append('student_name', studentName);
            formData.append('student_id', studentId);
            formData.append('score', `${score}/${questions.length}`);
            formData.append('percentage', `${percentage.toFixed(1)}%`);
            formData.append('date', new Date().toLocaleDateString());
            
            fetch('https://formspree.io/f/manayznq', {
                method: 'POST',
                body: formData,
                headers: {
                    'Accept': 'application/json'
                }
            })
            .then(response => {
                if (response.ok) {
                    console.log('Results submitted successfully');
                } else {
                    console.error('Failed to submit results');
                }
            })
            .catch(error => {
                console.error('Error submitting results:', error);
            });
        }

        function startReview(mode) {
            feedbackMode = mode;
            currentQuestionIndex = 0;
            
            resultsScreen.classList.remove('active');
            examScreen.classList.add('active');
            
            loadQuestion(currentQuestionIndex);
            
            // Update navigation for review mode
            if (mode === 'immediate') {
                // In immediate feedback mode, we'll show feedback after each selection
                // No need to change navigation
            } else {
                // In end feedback mode, we'll only show feedback at the end
                // We'll add a "Show Results" button at the end
                submitExamBtn.textContent = 'Show Results';
                submitExamBtn.style.display = 'none';
                nextBtn.style.display = 'inline-block';
            }
        }

        function retryExam() {
            // Reset exam state
            currentQuestionIndex = 0;
            userAnswers = new Array(questions.length).fill(null);
            timeLeft = 60 * 60; // Reset to 60 minutes
            feedbackMode = null;
            isPracticeMode = true;
            
            // Go to welcome screen
            resultsScreen.classList.remove('active');
            welcomeScreen.classList.add('active');
            updateWelcomeScreen();
        }
    </script>
</body>
  </html>
